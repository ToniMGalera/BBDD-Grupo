CREATE DATABASE masonescompany;
use masonescompany;

--proveedores
CREATE TABLE Proveedores (
    id_proveedor CHAR(5), 
    nombre NVARCHAR(100) NOT NULL,
    correo NVARCHAR (100) UNIQUE NOT NULL,
    telefono VARCHAR (14),
    direccion NVARCHAR (255),
    PRIMARY KEY (id_proveedor));

--tabla productos
CREATE TABLE Productos (
  id_producto INT AUTO_INCREMENT,
  nombre NVARCHAR(100) NOT NULL,
  descripcion TEXT,
  foto VARCHAR (255),
  precio DECIMAL(10,2) NOT NULL,
  stock INT NOT NULL,
  proveedor CHAR (5),
  PRIMARY KEY (id_producto),
  FOREIGN KEY (proveedor) REFERENCES Proveedores(id_proveedor) ON DELETE CASCADE ON UPDATE CASCADE);

--clientes
CREATE TABLE Clientes (
  id_cliente INT AUTO_INCREMENT,
  nombre NVARCHAR(100) NOT NULL,
  apellido_1 NVARCHAR(100) NOT NULL,
  apellido_2 NVARCHAR(100) NOT NULL,
  direccion VARCHAR(255) NOT NULL,
  correo VARCHAR(100) UNIQUE NOT NULL,
  telefono VARCHAR(14) NOT NULL,
  responsable NVARCHAR (100),
  PRIMARY KEY (id_cliente));

--pedidos
CREATE TABLE Pedidos (
  id_pedido INT AUTO_INCREMENT,
  fecha_pedido DATE,
  total_pedido DECIMAL(10,2),
  estado_pedido ENUM('pendiente', 'acceptado', 'en_preparación', 'enviado', 'entregado', 'cancelado'),
  cliente INT,
  PRIMARY KEY (id_pedido),
  FOREIGN KEY (cliente) REFERENCES Clientes(id_cliente));

CREATE TABLE Devoluciones (
  id_devolucion INT AUTO_INCREMENT,
  fecha_devolucion DATE,
  estado_devolucion ENUM('pendiente', 'enviado', 'por_recibir', 'entregado', 'cancelado', 'en_revision', 'acceptado'),
  cliente INT,
  pedido,
  PRIMARY KEY (id_devolucion),
  FOREIGN KEY (cliente) REFERENCES Clientes(id_cliente)),
  FOREIGN KEY (pedido) REFERENCES Pedidos(id_pedido));


--detalles pedidos
CREATE TABLE DetallesPedidos (
  id_detalle_pedido INT AUTO_INCREMENT,
  pedido_id INT,
  producto_id INT,
  cantidad INT,
  precio_unitario DECIMAL(10,2),
  subtotal DECIMAL(10,2),
  PRIMARY KEY (id_detalle_pedido),
  FOREIGN KEY (pedido_id) REFERENCES Pedidos(id_pedido),
  FOREIGN KEY (producto_id) REFERENCES Productos(id_producto));


INSERT INTO Clientes (id_cliente, nombre, apellido, dirección, correo, telefono)
VALUES
  (1, 'Juan', 'Pérez', 'Calle 1, 123', 'juan.perez@example.com', '123456789'),


INSERT INTO Productos (id_producto, nombre, descripción, precio, stock)
VALUES
  (1, 'Televisor', 'Televisor 4K', 500.00, 10),


INSERT INTO Ventas (id_venta, id_cliente, id_producto, fecha_venta, cantidad, precio_venta)
VALUES
  (1, 1, 1, '2022-01-01', 2, 1000.00),


INSERT INTO Pedidos (id_pedido, id_cliente, fecha_pedido, total_pedido)
VALUES
  (1, 1, '2022-01-01', 2000.00),
